import{i as c,c as w,a as o,d as e,g as _,k as $,v as D,s as K,t as l,h as p,F as R,n as T,l as V,o as n}from"./index-CxMTdPvu.js";import{u as B}from"./posts-DEk91uF9.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"search-page"},L={class:"search-box"},E={key:0,class:"loading"},I={key:1,class:"error"},M={key:2},U={class:"search-info"},j={key:0},q={key:1},z={key:0,class:"posts-table"},A=["onClick"],G={class:"title"},H={key:0,class:"comment-count"},J={key:1,class:"pagination"},O=["disabled"],Q={class:"page-info"},W=["disabled"],X={__name:"SearchPage",setup(Y){const P=V(),v=B(),h=c(""),i=c(""),d=c([]),u=c(null),r=c(1),g=c(!1),S=w(()=>v.loading),m=w(()=>v.error),y=async()=>{if(!h.value.trim()){alert("검색어를 입력하세요.");return}r.value=1,i.value=h.value,await k()},k=async()=>{g.value=!0;try{const a=v.getSearchResults(i.value,r.value);a&&(d.value=a.posts,u.value=a.pagination,console.log(`✨ 캐시된 검색 결과 사용 - "${i.value}" 페이지 ${r.value}`));const t=await v.searchPosts(i.value,r.value);d.value=t.posts,u.value=t.pagination}catch(a){console.error("검색 실패:",a)}},x=a=>{P.push(`/posts/${a}`)},b=a=>{r.value=a,k(),window.scrollTo({top:0,behavior:"smooth"})},C=a=>new Date(a).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"});return(a,t)=>{var f;return n(),o("div",F,[t[5]||(t[5]=e("h2",null,"게시글 검색",-1)),e("div",L,[$(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>h.value=s),onKeyup:K(y,["enter"]),placeholder:"검색어를 입력하세요"},null,544),[[D,h.value]]),e("button",{onClick:y,class:"btn btn-primary"},"검색")]),S.value?(n(),o("div",E,"검색 중...")):m.value?(n(),o("div",I,l(m.value),1)):g.value?(n(),o("div",M,[e("div",U,[d.value.length>0?(n(),o("p",j,[t[3]||(t[3]=p(' "',-1)),e("strong",null,l(i.value),1),p('" 검색 결과: '+l((f=u.value)==null?void 0:f.totalPosts)+"건 ",1)])):(n(),o("p",q,"검색 결과가 없습니다."))]),d.value.length>0?(n(),o("table",z,[t[4]||(t[4]=e("thead",null,[e("tr",null,[e("th",null,"번호"),e("th",null,"제목"),e("th",null,"작성자"),e("th",null,"조회수"),e("th",null,"작성일")])],-1)),e("tbody",null,[(n(!0),o(R,null,T(d.value,s=>(n(),o("tr",{key:s.id,onClick:Z=>x(s.id),class:"post-row"},[e("td",null,l(s.id),1),e("td",G,[p(l(s.title)+" ",1),s.comment_count>0?(n(),o("span",H,"["+l(s.comment_count)+"]",1)):_("",!0)]),e("td",null,l(s.username),1),e("td",null,l(s.view_count),1),e("td",null,l(C(s.created_at)),1)],8,A))),128))])])):_("",!0),u.value&&u.value.totalPages>1?(n(),o("div",J,[e("button",{onClick:t[1]||(t[1]=s=>b(r.value-1)),disabled:r.value===1,class:"btn-page"}," 이전 ",8,O),e("span",Q,l(r.value)+" / "+l(u.value.totalPages),1),e("button",{onClick:t[2]||(t[2]=s=>b(r.value+1)),disabled:r.value===u.value.totalPages,class:"btn-page"}," 다음 ",8,W)])):_("",!0)])):_("",!0)])}}},ae=N(X,[["__scopeId","data-v-6b62d88a"]]);export{ae as default};
