import{i,m as k,a as u,d as s,g as m,j as P,k as f,v as y,t as _,q as x,l as B,o as d}from"./index-CxMTdPvu.js";import{u as w}from"./posts-DEk91uF9.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const S={class:"post-edit"},V={key:0,class:"loading"},q={class:"form-group"},D={class:"form-group"},E={key:0,class:"error-message"},M={class:"form-actions"},$=["disabled"],C={__name:"PostEdit",setup(N){const v=B(),n=x(),c=w(),e=i({title:"",content:""}),p=i(!1),r=i(!1),l=i(""),b=async()=>{p.value=!0;try{const o=n.params.id,t=c.getPostById(o);t&&(e.value.title=t.title,e.value.content=t.content,console.log(`✨ 캐시된 게시글로 편집 폼 초기화 - ID ${o}`));const a=await c.fetchPostById(o);e.value.title=a.title,e.value.content=a.content}catch{l.value="게시글을 불러오는데 실패했습니다."}finally{p.value=!1}},g=async()=>{var o,t;r.value=!0,l.value="";try{await c.updatePost(n.params.id,e.value),console.log("✅ 게시글 수정 완료, 캐시 갱신됨"),v.push(`/posts/${n.params.id}`)}catch(a){l.value=((t=(o=a.response)==null?void 0:o.data)==null?void 0:t.message)||"게시글 수정에 실패했습니다."}finally{r.value=!1}},h=()=>{v.push(`/posts/${n.params.id}`)};return k(()=>{b()}),(o,t)=>(d(),u("div",S,[t[4]||(t[4]=s("h2",null,"게시글 수정",-1)),p.value?(d(),u("div",V,"로딩 중...")):e.value.title?(d(),u("form",{key:1,onSubmit:P(g,["prevent"])},[s("div",q,[t[2]||(t[2]=s("label",{for:"title"},"제목",-1)),f(s("input",{type:"text",id:"title","onUpdate:modelValue":t[0]||(t[0]=a=>e.value.title=a),required:"",maxlength:"200",placeholder:"제목을 입력하세요"},null,512),[[y,e.value.title]])]),s("div",D,[t[3]||(t[3]=s("label",{for:"content"},"내용",-1)),f(s("textarea",{id:"content","onUpdate:modelValue":t[1]||(t[1]=a=>e.value.content=a),required:"",rows:"15",placeholder:"내용을 입력하세요"},null,512),[[y,e.value.content]])]),l.value?(d(),u("div",E,_(l.value),1)):m("",!0),s("div",M,[s("button",{type:"submit",class:"btn btn-primary",disabled:r.value},_(r.value?"수정 중...":"수정하기"),9,$),s("button",{type:"button",onClick:h,class:"btn btn-secondary"}," 취소 ")])],32)):m("",!0)]))}},T=I(C,[["__scopeId","data-v-f7077e29"]]);export{T as default};
