import{u as S,i as d,c as _,m as x,a as i,d as t,f as B,g as v,w as D,h as g,t as n,F as L,n as $,r as A,l as N,o as l}from"./index-CxMTdPvu.js";import{u as T}from"./posts-DEk91uF9.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"post-list"},R={class:"header"},E={key:0,class:"loading"},I={key:1,class:"error"},K={key:2},M={class:"posts-table"},j=["onClick"],q={class:"title"},z={key:0,class:"comment-count"},G={key:0,class:"pagination"},H=["disabled"],J={class:"page-info"},O=["disabled"],Q={__name:"PostList",setup(U){const k=N(),b=S(),c=T(),u=d([]),r=d(null),a=d(1),y=_(()=>b.isAuthenticated),f=_(()=>c.loading),m=_(()=>c.error),p=async()=>{try{const s=c.getListByPage(a.value);s&&(u.value=s.posts,r.value=s.pagination,console.log(`✨ 캐시된 데이터 사용 - 페이지 ${a.value}`));const e=await c.fetchPosts(a.value);u.value=e.posts,r.value=e.pagination}catch(s){console.error("게시글 로딩 실패:",s)}},P=s=>{k.push(`/posts/${s}`)},h=s=>{a.value=s,p(),window.scrollTo({top:0,behavior:"smooth"})},w=s=>new Date(s).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"});return x(()=>{p()}),(s,e)=>{const C=A("router-link");return l(),i("div",F,[t("div",R,[e[3]||(e[3]=t("h2",null,"게시판",-1)),y.value?(l(),B(C,{key:0,to:"/posts/create",class:"btn btn-primary"},{default:D(()=>[...e[2]||(e[2]=[g("글쓰기",-1)])]),_:1})):v("",!0)]),f.value?(l(),i("div",E,"로딩 중...")):m.value?(l(),i("div",I,n(m.value),1)):(l(),i("div",K,[t("table",M,[e[4]||(e[4]=t("thead",null,[t("tr",null,[t("th",null,"번호"),t("th",null,"제목"),t("th",null,"작성자"),t("th",null,"조회수"),t("th",null,"작성일")])],-1)),t("tbody",null,[(l(!0),i(L,null,$(u.value,o=>(l(),i("tr",{key:o.id,onClick:W=>P(o.id),class:"post-row"},[t("td",null,n(o.id),1),t("td",q,[g(n(o.title)+" ",1),o.comment_count>0?(l(),i("span",z,"["+n(o.comment_count)+"]",1)):v("",!0)]),t("td",null,n(o.username),1),t("td",null,n(o.view_count),1),t("td",null,n(w(o.created_at)),1)],8,j))),128))])]),r.value?(l(),i("div",G,[t("button",{onClick:e[0]||(e[0]=o=>h(a.value-1)),disabled:a.value===1,class:"btn-page"}," 이전 ",8,H),t("span",J,n(a.value)+" / "+n(r.value.totalPages),1),t("button",{onClick:e[1]||(e[1]=o=>h(a.value+1)),disabled:a.value===r.value.totalPages,class:"btn-page"}," 다음 ",8,O)])):v("",!0)]))])}}},tt=V(Q,[["__scopeId","data-v-a727c3b0"]]);export{tt as default};
